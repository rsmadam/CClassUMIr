---
title: "Fig1cd_clinicalDatasets"
output: html_document
---

## R Markdown

```{r}
library(ggplot2)
paletteCMSn=c("CMS1" ="#E79E1B", 
             "CMS2"= "#0071B1", 
             "CMS3"= "#C45597",#Guinney:"#C977A4", 
              "CMS4"="#009C74",
             "NOLBL"="#d3d3d3")

## plot VU predictions
listCMSlabs <- list("COAD"= miR_COAD_vst$CMS, 
                    "READ"=miR_READ_vst_BR$CMS.lv, 
                    "CPTAC2"=clinSupp.cptac$CMS )
for (CMSvec in c("COAD","READ","CPTAC2")) {
CMSvecN <- factor(listCMSlabs[[CMSvec]], 
                  levels=c("CMS1", "CMS2", "CMS3", "CMS4", "NOLBL"),
                  ordered = T)
CMSvecN[is.na(CMSvecN)] <- "NOLBL"

data.frame("CMS"=CMSvecN) %>% 
  ggplot(aes(x = CMS, fill = CMS )) +
  geom_bar() +
  theme_minimal() + 
  ylim(0, 110) +
  scale_fill_manual(values=c(paletteCMSn)) + #"#4F2776"
  ggtitle(paste0("CMS in ", CMSvec))
ggsave(paste0(plotDir, "CMS_input_counts_", CMSvec, "_barplots.pdf"))
}

###summary stats table
round(summary(miR_COAD_vst$CMS)/445*100,1) #this is the entire dataset of COAD without normal/extra samples
##COAD training set
round(summary(rc_vst_BR$CMS)/271*100,1) #this is after outlier and NA/inconsistency removal
round(summary(factor(sub("[A,B,C]$","",clinical.coad$ajcc_pathologic_stage[which(clinical.coad$submitter_id %in% rownames(rc_vst_BR))])))/271*100,1) #this is after outlier and NA/inconsistency removal
summary(clinical.coad$age_at_diagnosis[which(clinical.coad$submitter_id %in% rownames(rc_vst_BR))]/365)
##READ validation set
round(summary(miR_READ_vst_BR$CMS.lv)/158*100,1)
round(summary(factor(sub("[A,B,C]$","",clinical.read$ajcc_pathologic_stage[which(clinical.read$submitter_id %in% rownames(miR_READ_vst_BR))])))/158*100,1) 
summary(clinical.read$age_at_diagnosis[which(clinical.read$submitter_id %in% rownames(miR_READ_vst_BR))]/365)
##CPTAC2 validation set
summary(clinSupp.cptac$CMS)/105
summary(clinSupp.cptac$Age/12)
##VUdata
summary(clinVU$Stage[grep("primary_CRC",clinVU$sampleType)])/126*100


```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
